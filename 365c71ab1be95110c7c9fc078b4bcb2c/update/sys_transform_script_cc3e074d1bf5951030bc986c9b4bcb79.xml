<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_transform_script">
    <sys_transform_script action="INSERT_OR_UPDATE">
        <active>true</active>
        <map display_value="Accounts">40e787c51bf5951030bc986c9b4bcbb1</map>
        <order>100</order>
        <script><![CDATA[(function runTransformScript(source, map, log, target /*undefined onStart*/ ) {
	gs.info('In script');
	var insert = true;
	var gr = new GlideRecord('cmn_location');
	gr.addQuery('u_legacy_id', source.u_id__s_);
	gr.query();
	if (gr.next()) {
		gs.info('Location with legacy id:' + source.u_id__s_ + ' already exist');
		insert = false;
	}
	else {
		gs.info('Location with legacy id:' + source.u_id__s_ + ' does not exist');
		gr.initialize();
	}
	gr.u_legacy_id = source.u_address_id;
	gr.zip = source.u_zip_code;
	gr.city = source.u_city;
	gr.country = source.u_country_code;
	gr.state = source.u_county_code;
	gr.street = source.u_street + ', nr. ' + source.u_street_nr;
	if (source.u_block) {
		gr.street += ', block ' + source.u_block;
	}
	if (source.u_entrance) {
		gr.street += ', entrance ' + source.u_entrance;
	}
	if (source.u_flat) {
		gr.street += ', flat ' + source.u_flat;
	}
	gr.name = gr.country + ', ' + gr.street;
	if (insert) {
		var location_id = gr.insert();
		target.u_location = location_id;
	}
	else
		gr.update();
})(source, map, log, target);]]></script>
        <sys_class_name>sys_transform_script</sys_class_name>
        <sys_created_by>samson</sys_created_by>
        <sys_created_on>2022-09-06 09:27:49</sys_created_on>
        <sys_id>cc3e074d1bf5951030bc986c9b4bcb79</sys_id>
        <sys_mod_count>13</sys_mod_count>
        <sys_name>onBefore</sys_name>
        <sys_package display_value="CMB" source="x_tsigh_cmb">365c71ab1be95110c7c9fc078b4bcb2c</sys_package>
        <sys_policy/>
        <sys_scope display_value="CMB">365c71ab1be95110c7c9fc078b4bcb2c</sys_scope>
        <sys_update_name>sys_transform_script_cc3e074d1bf5951030bc986c9b4bcb79</sys_update_name>
        <sys_updated_by>samson</sys_updated_by>
        <sys_updated_on>2022-09-06 12:10:35</sys_updated_on>
        <when>onBefore</when>
    </sys_transform_script>
</record_update>
